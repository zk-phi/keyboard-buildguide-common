[< 記事一覧](Readme.markdown)

# Neopixel LED の実装

一球一球にマイコンを内臓し、複雑な発光パターンを実装できる LED です。

LED たちは直列に接続されており、 ProMicro からコマンドをバケツリレー式に流してゆくことで同期します。したがって、途中のどこかの LED に不具合があると、そこから後ろの LED すべてに不具合が出ることが多いです。また、先頭から順番につけていかないと動作確認ができません。

実装順については各キーボードの組立ガイドに書いていますので、そちらを参照してください。

LED には４つのパッドがあり、正しい向きで取り付けないと正しく動作しません。バージョンによって見分け方が異なる場合もあるので、購入したお店で配布しているデータシートなどを確認してください。

またバージョンを混在するとうまく動作しないこともあるようなので、バラバラのお店で購入したものを一緒に使うことはおすすめしません。

最近登場した SK6812mini-E (タブがある) と、従来から使われている SK6812mini (タブがない) には互換性がありません。基板がどちらに対応しているかを確認して、正しい方の LED をつけるように注意してください。

## 半田ごての設定

Neopixel LED は熱に弱いため、こて先の温度を抑えて半田付けすることが推奨されています (実際、簡単に壊れます)。

240 度で半田付けするのが公式っぽいですが、温度が低すぎると半田を溶かすのが大変なので自分は 270 度でやっています。 320 度までいってしまうと相当手際よく付けていかない限り壊してしまうと思うので、おすすめしません。

## 動作確認について

LED の半田付けは失敗しやすいので、最初の方は１つつけるごとに動作確認するのがおすすめです。コンスルー・ファームウェアを仕込んだ ProMicro を基板に差し込み、 USB を接続した時にちゃんと LED が光れば成功です。

光らない、あるいは光るもののチカチカしたり、一つだけ色がおかしかったりする場合は半田不良の可能性が高いです。ひとつの LED に半田不良があると、そこから後ろの LED も正しく動作しなくなってしまうので、コツコツ修正しながら次に進みましょう。

## 実装
### 背面実装の場合

LED の Vcc が、基板上のコの字の目印で示されたパッドに対応するようにはめ込みます。穴から抜けてしまう場合はマステなどで軽く固定しておくと付けやすいです。

![neopixel_backlight](img/neopixel_backlight.jpg)

基板側・ LED 側のパッド両方をうまくこてで温めて、半田を流してブリッジさせます。

### 表面実装の場合

LED の Vcc が、基板のコの字の印に対応するように置いて、半田付けします。

![neopixel_underglow](img/neopixel_underglow.jpg)

私の場合、あらかじめひとつのパッドに軽く半田を盛っておいて、ちりとりで半田を集めるように LED を押し込み、仮止めしています。枠を大きくはみ出して付けてしまうとケースに干渉してしまうことがあるので、このタイミングで丁寧に位置合わせしましょう。

残りのピンは、基板側のパッドと LED 側面のパッドの両方をこてで温め、半田を流してブリッジさせれば ok です。基板側のパッドにだけ半田がついてしまう場合がまれによくあるので、ちゃんと LED 側にもついていることを確認しましょう。
